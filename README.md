# *Highload Архитектура*

Расчётно-пояснительная записка

Домашнее задание по курсу Highload

Выполнено студентом 3-го семестра: Ширшов А.С.

  

---

## **О Сервисе**

Reddit - сервис, сочетающий в себе черты социальной сети и форума, где пользователи могут размещать информацию и заниматься её непосредственным обсуждением.

  

## **MVP**

- Регистрация и авторизация на сервисе

- Возможность создания форумов, постов

- Просмотр постов других пользователей

- Возможность комментирования постов

- Система голосования

## **Целевая аудитория**

- 430 млн активных пользователей Ежемесячно

- Сервис наиболее популярен среди населения возрастной группы от 25 до 29 лет. На неё приходится примерно 23% пользователей.

- Следом идёт возрастная группа от 18 до 24 лет. Они составляют 21% пользователей, что показывает популярность сервиса среди молодёжи.

- Основная часть пользователей приходится на Северную Америку и Европу

### Статистика

- https://aliexpress.inform.click/10-statisticheskih-dannyh-reddit-kotorye-vy-dolzhny-znat-v-2021-godu-infografika/

  

## **Расчёт нагрузки**

- Месячная аудитория: 430 млн пользователей

- Суточная аудитория: 52 млн пользователей

    (Данные были взяты из статистического анализа, приложенного пунктом выше)

- Средний размер хранилища пользователя


Будем считать пользователь пользователь оставляет по комментарию в день под каждым интересующим его форумом. Длина комментария в среднем от 20 до 80 символов. Пусть пользователь подписан на 10 форумов. Также пользователь может иметь свой форум, где может выкладывать собственные посты. Допустим пользователь делает иногда фотографии и выкладывает их в сервис с периодичностью 2 недели.

| Комметарий    | Кол-во комментариев       | Пост (Изображение)      |
|:-------------:|:-------------------------:|:-----------------------:|
| 0.1 Kb        | 10 * 14                   |         ~750 kb         |

Выходит: 0,89 Mb каждые две недели выходит от пользователя. Сервис существует с 2005 года. То есть если пользователь зарегистрировался примерно в 2013 году, (средняя дата), то результат выходит: 0,89 * 2 * 12 * 8 = 170,88 Mb

- Среднее кол-во действий пользователя в день

По статистике в среднем пользователи проводят на сайте 10 минут 23 секунды. 

 1. Пользователи в основном листают ленту, состоящую из постов, подписанных форумов, а также рекомендации. Также пользователь может оставить комментарий под постом. За 10 минут пользователь тратя по 10 секунд на пост и иногда оставляя комментарии в среднем просмотрит около 40 постов и напишет 2-5 комментариев. Также учтём, что пользователь оценит хотя бы половину постов, ибо это сделать намного проще, чем оставить коментарий, а просматривает он в основном интересующие его форумы. 
 2. Также пользователи могут создавать форумы и выкладывать собственные посты. Если личных форумов на пользователя приходится немного за всё время использования, то для постов воспользуемся моделью пользователя описанного выше (пост раз в две недели).
 3. Пользователи могут просматривать чужие профили. Если считать, что пользователь будет смотреть профиль пользователя, выложившего заинтересовавший его пост (считаем, что комментарий -> интерес), то выйдет 2-5 профиля в день.

 4. Пользователь может искать форумы по интересующей его тематике, часто это связано с актуальными новостями в обществе, то есть по 1 поисковому запросу в день.
 
 Выходит в день:

| Посты (Просмотр)             |  Комментариии       | Профили   | Оценки | Поиск  | Пост (Выложить)|
|:----------------------------:|:-------------------:|:---------:|:------:|:------:|:--------------:|
| 40 (Лента загружается 1 раз) | 2-5                 |     2-5   | 20     |1       | 0,0714         |






### **Технические метрики**

- Размер хранения

1) У пользователей есть профили, где находится краткая информация о них, а также персональный аватар.

| Аватар        | Информация о пользователе | Суммарные данные |
|:-------------:|:-------------------------:|:----------------:|
| 750 KB        | 1 Kb                      |         0.75 Mb  |

2) Сервис разбивается на форумы, где можно размещать посты, комментировать их, а также оценивать пост по системе лайк/дизлайк. Также посты могут содержать изображения и видео. Так как форумы разделяются на крупные(> 500 тыс подписок), средние(> 10 тыс подписок) и локальные(< 10 тыс подписок), возьмём за среднее значение форум с 50 тыс. участников. Такой форум должен существовать примерно несколько лет, чтобы собрать такую аудиторию. Возьмём значение 2 года. В день для поддерджания аудитории выкладывается по 2-3 поста. Каждый пост в среднем содержит изображение, реже небольшой видеоматериал, и подпись от 20 до 80 символов, и каждый пост содержит около 20 комментариев и в среднем 300 голосов.
Тогда:

| Комметарий    | Кол-во комментариев       | Пост (с медиасодержимым)| Кол-во постов                |
|:-------------:|:-------------------------:|:-----------------------:|:----------------------------:|
| 0.1 Kb        | 20                        |         ~1.5 Mb         | 2.5 поста * 365 дней * 2 года|

*Содержимое стобца пост уже включает голоса

*Также форум содержит информацию о нём, но она много меньше его содержимого, поэтому в подсчёт не входит.

Выходит средний форум содержит около 1825 постов по 20 комментариев в каждом. Получается: 1825 * (1,5 +20*0.001) = 2920 Mb на форум ~ 2,85 Gb

По статистике реддит содержит примерно около 2 млн форумов: 2,85 Gb * 2 000 000 ~ 1113 Tb. Так как за расчёт мы брали не являющимся крупным форум срок существования которому два года, а время существования сервиса уже больше 15 лет, то данное количество данных следует увеличить примерно в 5 раз (Число меньше, чтобы опустить неактивные форумы, созданных за время существования сервиса). -> 5569 Tb

- Сетевой трафик

Если возьмём полученные данные выше, что пользователь в день загружает 170,88 Mb, а суточная аудитория составляет 52 млн пользователей, то выходит 170,88 * 52 000 000 = 100,4 Gb/s

- RPS

Если возьмём полученные данные выше, что пользователь совершает около 28,0724 действий в день, а суточная аудитория составляет 52 млн пользователей, то выходит 16895 RPS 